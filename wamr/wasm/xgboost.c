
/* xgboost benchmark

   Contributor Zachary Susskind <zsusskind@utexas.edu>
   Contributor Konrad Moron <konrad.moron@tum.de>

   This file is part of Embench.

   SPDX-License-Identifier: GPL-3.0-or-later
   */
#include <stdint.h>
#include <stddef.h>
#define SAMPLES_IN_FILE 32
#define SAMPLE_SIZE 64
#define NUM_CLASSES 10
#define NUM_TREES 10

#ifndef SCALE_FACTOR
#define SCALE_FACTOR 1
#endif

const uint8_t tree_sizes[] = {8,15,13,13,12,10,12,15,14,15,7,13,14,14,13,10,12,13,14,14,8,13,13,14,13,10,12,10,14,14,7,14,12,14,13,11,12,11,14,15,7,12,14,14,12,13,12,12,13,15,7,11,13,14,14,12,12,12,11,14,7,13,12,14,12,11,11,12,10,13,9,14,14,13,13,13,9,12,9,13,8,13,12,14,13,13,10,10,10,13,9,13,12,11,11,13,10,10,10,13,};

const uint8_t comparison_idxs[] = {36,28,12,21,36,13,33,52,19,10,38,20,3,12,6,20,45,26,10,63,21,38,11,62,26,45,37,54,38,52,54,51,26,12,27,19,26,43,27,19,51,26,10,28,9,29,11,30,18,33,58,50,33,30,12,17,41,13,4,13,5,21,5,15,13,42,58,43,18,5,26,21,42,42,2,54,21,13,61,53,1,38,5,60,26,53,52,18,29,17,37,29,10,9,19,5,6,33,38,42,27,45,51,62,38,51,43,21,22,9,18,38,29,21,43,51,42,33,4,62,42,36,29,27,35,12,43,36,28,45,13,36,6,28,20,19,10,63,37,58,19,59,27,34,37,42,33,62,37,46,54,54,45,57,44,26,45,43,19,59,52,26,43,11,30,51,18,28,4,41,4,2,54,54,18,58,33,33,34,44,30,12,25,50,33,12,12,13,21,5,15,42,42,58,5,22,5,25,21,42,42,59,61,33,13,4,20,46,51,44,53,26,20,37,14,7,35,52,61,18,52,24,19,38,42,27,45,51,62,38,52,43,27,14,62,58,40,29,43,44,52,60,42,28,29,21,43,11,21,17,26,36,28,51,13,36,44,42,34,19,10,46,20,3,30,6,26,10,9,2,63,61,26,62,63,49,43,51,27,37,43,28,10,9,52,26,43,11,30,51,1,28,63,42,4,2,34,17,20,58,33,33,35,44,30,12,41,30,5,4,13,21,21,5,15,42,42,58,20,22,51,26,21,42,42,59,54,33,13,53,9,46,22,45,61,26,20,38,17,6,43,52,36,7,38,21,27,52,35,9,43,21,9,20,20,62,42,34,21,51,42,21,54,18,34,25,17,51,5,43,34,5,36,42,26,13,36,45,28,19,10,46,20,3,30,6,41,14,10,9,61,18,50,26,38,63,27,4,51,27,45,36,63,9,52,26,43,11,30,50,54,28,19,42,2,36,18,20,19,33,2,44,34,4,10,12,52,21,22,61,33,37,21,5,15,42,58,21,36,43,22,36,9,21,42,42,59,49,33,60,50,19,46,21,49,61,26,20,29,17,6,43,60,53,7,14,38,42,27,45,43,9,43,36,43,21,17,26,42,34,21,44,42,62,6,18,34,21,35,17,3,5,27,34,14,36,28,50,50,36,21,52,20,19,10,63,42,34,19,3,4,2,58,33,26,51,63,45,53,62,27,61,63,61,19,9,52,52,26,43,11,30,50,1,22,46,33,2,51,26,12,19,58,34,12,38,62,53,30,51,45,18,33,58,21,5,14,36,2,2,30,53,25,5,18,7,3,21,42,42,59,49,33,58,9,19,46,22,45,61,26,20,37,29,6,43,52,50,18,12,14,38,42,27,46,43,62,58,43,26,27,50,27,34,21,44,43,62,6,27,36,21,4,17,3,35,10,17,9,36,42,45,13,36,37,28,19,3,46,20,30,6,5,50,54,62,61,26,51,62,50,53,3,17,62,29,61,27,54,37,26,43,11,19,51,1,14,30,46,4,2,26,45,27,33,34,44,12,50,50,20,53,41,5,10,60,2,41,21,5,14,36,42,58,30,60,9,18,6,6,21,42,42,42,54,21,13,53,9,38,29,59,61,26,20,10,29,7,27,12,37,52,34,14,38,42,38,45,50,10,31,36,43,21,58,21,44,42,42,59,36,34,4,14,17,18,26,34,51,36,28,51,13,28,34,21,10,20,19,55,41,25,29,34,19,26,6,51,9,26,38,62,27,4,50,17,51,44,63,54,61,26,45,12,13,42,26,21,22,29,29,46,2,51,11,58,34,12,49,51,53,30,5,41,18,33,58,21,5,15,43,42,6,20,18,6,11,36,21,42,42,54,33,60,18,9,46,21,49,61,26,20,29,17,14,43,27,50,34,28,18,35,22,50,52,54,21,44,20,17,51,21,44,43,42,6,42,35,4,17,3,3,17,9,28,21,38,43,34,28,42,36,3,10,42,19,14,20,25,21,30,18,3,51,12,9,45,26,43,62,28,53,53,17,62,44,49,27,54,54,43,43,30,58,46,46,47,44,18,36,54,51,43,18,33,12,44,18,41,10,13,60,27,13,43,37,43,21,5,6,43,20,14,45,20,58,18,4,30,14,21,42,12,61,2,5,4,20,21,61,26,20,10,29,61,46,14,53,18,12,22,35,22,13,52,50,50,22,54,58,21,44,44,42,59,42,26,4,14,17,26,44,46,28,13,38,21,42,28,62,41,10,20,19,4,37,25,21,62,17,41,42,9,45,26,45,62,61,43,54,27,27,10,52,26,37,26,43,12,4,5,26,21,1,34,52,29,25,54,11,33,12,44,4,10,10,13,29,45,4,50,37,26,58,21,26,5,52,6,21,2,59,20,10,28,14,42,43,21,28,41,30,58,59,29,13,61,26,19,38,17,11,52,46,18,46,38,35,38,22,12,18,42,21,18,33,21,44,43,62,9,27,34,21,4,35,36,60,5,28,36,38,21,3,28,43,18,41,10,20,19,4,34,3,36,34,18,41,25,52,18,26,54,62,61,43,20,59,45,28,10,62,51,33,45,27,18,18,26,14,37,2,2,44,58,34,53,51,12,59,43,41,5,18,53,58,21,26,5,41,6,21,42,12,20,10,54,14,42,43,54,28,18,13,19,59,9,21,61,29,19,52,26,11,26,26,50,17,35,22,50,30,17,51,20,2,44,35,42,36,36,21,30,43,14,62,27,53,58,42,51,};

const uint8_t comparison_values[] = {1,5,200,1,4,3,1,15,14,1,1,15,4,15,1,10,14,14,2,3,18,2,16,3,2,2,3,78,1,15,2,16,7,3,1,14,4,3,177,9,9,6,12,8,6,8,8,1,3,9,1,13,4,9,36,2,9,8,1,1,10,2,7,51,7,14,7,1,10,12,15,1,10,81,1,2,4,10,8,14,1,6,24,3,13,1,10,14,11,49,1,9,14,11,1,11,15,5,1,8,13,12,13,9,2,3,4,5,1,4,13,4,14,16,1,1,1,4,2,2,4,11,13,3,14,46,4,1,5,231,2,4,2,1,16,15,14,14,3,9,191,1,15,3,17,14,4,3,3,6,2,33,8,2,4,7,1,43,15,16,14,6,5,114,2,9,3,33,9,5,16,16,2,7,55,1,5,11,14,8,9,7,10,1,9,36,5,5,2,4,51,1,14,7,1,1,12,3,1,8,81,8,4,7,10,20,9,15,15,39,1,13,125,1,13,2,17,3,1,3,6,8,8,1,4,13,11,14,9,4,1,4,10,5,10,5,1,13,1,6,3,3,10,14,6,16,10,2,8,5,12,1,5,224,3,4,9,4,13,12,1,1,13,4,1,1,7,2,3,9,7,10,7,1,2,5,2,199,14,2,9,8,9,8,8,6,5,114,2,9,1,33,1,10,16,16,1,2,33,1,2,10,150,8,9,7,8,9,12,1,5,1,3,4,51,1,14,7,5,5,5,11,1,8,81,8,1,7,76,14,2,15,2,89,1,13,139,1,30,16,1,5,4,2,1,5,13,1,12,8,8,1,13,1,15,4,16,2,11,1,6,8,16,5,137,4,15,8,2,9,1,1,1,4,213,2,4,1,1,12,1,2,13,4,5,1,6,3,2,4,10,1,1,7,1,2,13,20,199,14,11,7,3,8,8,6,5,114,2,4,5,33,11,10,8,88,1,8,109,5,1,11,11,1,4,36,12,11,14,10,12,7,3,4,51,1,2,9,10,2,5,3,46,1,8,81,8,3,7,11,3,9,15,9,4,1,13,139,2,30,16,1,1,4,2,11,1,4,13,9,16,8,8,7,10,4,3,12,16,2,11,1,6,11,14,5,137,7,8,15,2,2,5,1,12,1,5,201,5,4,1,15,15,15,14,14,8,17,191,4,14,3,11,4,7,14,2,1,4,9,14,2,3,12,18,12,8,8,7,5,114,2,4,1,14,1,3,5,122,10,16,109,1,9,3,10,1,1,9,15,164,14,10,4,4,2,38,2,2,8,1,14,10,12,5,2,11,1,8,81,8,3,7,3,2,9,15,2,96,1,10,139,3,11,16,1,5,24,8,9,11,1,4,13,1,16,9,5,11,13,11,11,9,2,11,1,4,11,14,3,123,7,8,15,2,11,1,5,3,1,4,232,2,4,1,1,10,4,2,14,1,1,7,12,1,16,12,9,11,9,15,4,27,9,13,3,12,14,15,2,8,5,114,9,9,1,2,4,6,16,16,10,12,121,5,14,8,4,1,3,16,1,9,12,2,16,6,3,4,2,38,2,12,7,1,13,12,8,3,2,1,8,81,6,3,6,76,14,2,6,1,6,1,10,139,2,11,2,34,14,1,3,13,11,1,4,4,9,3,11,11,7,4,9,5,11,1,6,4,1,11,137,11,9,15,1,9,1,26,1,5,229,3,1,1,13,9,10,16,4,6,11,13,1,16,17,3,15,4,9,1,9,14,20,171,9,9,2,3,15,16,8,7,16,14,9,10,4,5,7,14,6,1,11,112,1,9,3,1,15,1,9,13,6,14,10,7,7,2,51,1,5,11,7,9,1,160,3,1,6,81,3,7,11,14,2,15,9,4,1,13,139,10,30,11,1,13,24,10,45,4,6,7,4,5,2,1,6,12,11,14,11,1,4,4,14,11,48,14,15,2,2,5,3,3,4,74,2,3,5,168,4,14,9,8,16,10,15,11,9,9,5,15,15,10,4,10,9,5,9,8,4,175,9,3,16,4,14,15,12,11,4,2,9,1,13,56,15,7,3,9,6,6,10,2,3,8,15,6,1,8,5,167,7,16,5,9,7,2,11,1,12,38,13,7,2,16,1,1,9,1,6,1,4,6,44,20,9,6,1,10,139,2,11,2,2,1,6,8,9,9,6,7,9,5,4,3,1,3,14,11,1,2,4,1,9,14,14,1,15,1,8,1,3,4,74,5,6,5,5,2,9,12,16,6,17,11,9,4,8,7,1,4,10,9,7,9,2,30,15,5,3,9,15,14,2,8,5,16,9,8,10,4,1,10,105,8,6,2,112,2,3,8,8,1,1,8,5,16,1,3,5,13,7,1,11,9,171,4,12,5,12,4,16,3,35,9,16,6,9,8,55,8,10,2,10,2,10,132,1,18,20,5,6,3,8,1,6,4,12,15,11,145,1,5,1,9,1,4,11,12,4,66,7,8,11,15,3,1,3,4,74,1,3,5,9,9,2,6,13,16,6,17,4,8,10,16,7,11,8,19,9,2,2,6,4,12,4,2,8,8,14,11,1,7,177,1,11,1,2,15,1,7,1,1,9,3,15,7,5,8,6,1,28,4,7,1,11,11,15,4,12,1,12,4,16,6,35,9,16,4,9,14,6,16,13,2,1,2,10,132,9,13,20,11,2,24,30,6,7,4,3,3,14,1,3,6,182,5,11,123,5,1,2,12,9,8,5,2,11,26,};

const uint8_t left_children[] = {1,3,4,5,7,131,133,135,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,5,7,9,10,11,130,132,134,136,138,140,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,5,7,9,11,129,131,133,135,137,139,1,3,5,6,7,130,131,133,135,137,1,3,5,7,8,10,130,131,133,135,137,139,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,4,130,6,132,134,1,3,5,7,8,10,12,130,132,134,136,138,140,1,3,5,7,9,11,13,129,131,133,135,137,139,141,1,3,5,7,9,11,128,129,131,133,135,137,139,141,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,5,6,7,130,131,133,135,137,1,3,5,128,7,9,130,131,133,135,137,139,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,4,5,7,131,133,135,1,3,5,128,7,9,11,130,132,134,136,138,140,1,3,5,7,9,11,12,130,132,134,136,138,140,1,3,5,7,9,11,128,129,131,133,135,137,139,141,1,3,5,7,8,10,12,130,132,134,136,138,140,1,3,5,6,7,130,131,133,135,137,1,3,5,128,7,9,11,131,133,135,137,139,1,3,5,7,9,129,131,133,135,137,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,128,8,10,12,129,131,133,135,137,139,141,1,128,4,130,6,132,134,1,3,5,128,8,10,12,129,131,133,135,137,139,141,1,3,5,7,9,10,11,131,133,135,137,139,1,3,5,7,9,11,128,129,131,133,135,137,139,141,1,3,5,128,8,10,12,130,132,134,136,138,140,1,3,5,6,7,9,130,132,134,136,138,1,3,5,128,7,9,11,131,133,135,137,139,1,3,5,7,9,10,130,132,134,136,138,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,4,130,6,132,134,1,3,5,7,8,10,11,131,133,135,137,139,1,3,5,7,9,11,13,129,131,133,135,137,139,141,1,3,5,7,9,11,13,129,131,133,135,137,139,141,1,3,5,128,7,9,10,131,133,135,137,139,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,5,128,7,9,11,131,133,135,137,139,1,3,5,7,9,11,129,131,133,135,137,139,1,3,5,7,9,128,12,130,132,134,136,138,140,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,128,4,130,6,132,134,1,3,4,129,7,9,130,132,134,136,138,1,3,5,7,9,11,12,130,132,134,136,138,140,1,3,5,7,9,11,13,129,131,133,135,137,139,141,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,5,7,9,128,129,131,133,135,137,139,1,3,5,128,7,9,11,131,133,135,137,139,1,3,5,7,9,11,129,131,133,135,137,139,1,3,5,7,128,129,130,132,134,136,138,1,3,5,7,8,10,12,129,131,133,135,137,139,141,1,3,4,130,6,132,134,1,3,5,7,9,128,12,130,132,134,136,138,140,1,3,5,7,9,10,11,131,133,135,137,139,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,5,128,7,9,10,131,133,135,137,139,1,3,5,6,7,9,130,132,134,136,138,1,128,4,6,8,10,130,132,134,136,138,1,3,5,7,9,128,129,131,133,135,137,139,1,128,4,129,6,8,131,133,135,137,1,3,5,7,8,10,11,130,132,134,136,138,140,1,3,5,128,130,8,132,134,136,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,5,7,128,10,11,130,132,134,136,138,140,1,3,5,128,8,129,11,130,132,134,136,138,140,1,3,5,7,8,10,129,130,132,134,136,138,140,1,128,4,6,129,8,132,134,136,1,3,5,7,9,11,129,131,133,135,137,139,1,128,4,129,131,7,132,134,136,1,3,5,7,8,10,11,130,132,134,136,138,140,1,3,5,129,131,7,133,135,1,3,5,7,9,129,11,130,132,134,136,138,140,1,3,5,7,9,129,130,131,133,135,137,139,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,5,7,8,129,11,130,132,134,136,138,140,1,3,5,7,128,9,11,130,132,134,136,138,140,1,128,4,129,6,8,131,133,135,137,1,3,128,6,8,129,131,133,135,137,1,3,5,128,7,130,131,133,135,137,1,3,5,7,128,9,11,130,132,134,136,138,140,1,3,5,6,129,8,132,134,136,1,3,5,7,9,129,11,130,132,134,136,138,140,1,3,128,6,8,10,129,131,133,135,137,139,1,3,5,6,8,10,130,132,134,136,138,1,128,4,6,8,129,130,132,134,136,138,1,3,5,7,128,9,11,130,132,134,136,138,140,1,128,4,129,6,8,131,133,135,137,1,3,128,6,8,129,131,133,135,137,1,128,4,129,6,8,131,133,135,137,1,3,5,7,9,11,12,130,132,134,136,138,140,};

const uint8_t right_children[] = {2,128,129,6,130,132,134,136,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,4,6,8,128,129,12,131,133,135,137,139,141,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,6,8,10,128,130,132,134,136,138,140,2,4,128,129,8,9,132,134,136,138,2,4,6,128,9,129,11,132,134,136,138,140,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,128,129,5,131,133,135,2,4,6,128,9,11,129,131,133,135,137,139,141,2,4,6,8,10,12,128,130,132,134,136,138,140,142,2,4,6,8,10,12,13,130,132,134,136,138,140,142,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,128,129,8,9,132,134,136,138,2,4,6,129,8,10,11,132,134,136,138,140,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,128,129,6,130,132,134,136,2,4,6,129,8,10,12,131,133,135,137,139,141,2,4,6,8,10,128,129,131,133,135,137,139,141,2,4,6,8,10,12,13,130,132,134,136,138,140,142,2,4,6,128,9,11,129,131,133,135,137,139,141,2,4,128,129,8,9,132,134,136,138,2,4,6,129,8,10,130,132,134,136,138,140,2,4,6,8,128,130,132,134,136,138,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,7,9,11,13,130,132,134,136,138,140,142,2,3,129,5,131,133,135,2,4,6,7,9,11,13,130,132,134,136,138,140,142,2,4,6,8,128,129,130,132,134,136,138,140,2,4,6,8,10,12,13,130,132,134,136,138,140,142,2,4,6,7,9,11,129,131,133,135,137,139,141,2,4,128,129,8,10,131,133,135,137,139,2,4,6,129,8,10,130,132,134,136,138,140,2,4,6,8,128,129,131,133,135,137,139,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,128,129,5,131,133,135,2,4,6,128,9,129,130,132,134,136,138,140,2,4,6,8,10,12,128,130,132,134,136,138,140,142,2,4,6,8,10,12,128,130,132,134,136,138,140,142,2,4,6,129,8,130,11,132,134,136,138,140,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,6,129,8,10,130,132,134,136,138,140,2,4,6,8,10,128,130,132,134,136,138,140,2,4,6,8,10,11,129,131,133,135,137,139,141,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,3,129,5,131,133,135,2,128,5,6,8,10,131,133,135,137,139,2,4,6,8,10,128,129,131,133,135,137,139,141,2,4,6,8,10,12,128,130,132,134,136,138,140,142,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,4,6,8,10,11,130,132,134,136,138,140,2,4,6,129,8,10,130,132,134,136,138,140,2,4,6,8,10,128,130,132,134,136,138,140,2,4,6,8,9,10,131,133,135,137,139,2,4,6,128,9,11,13,130,132,134,136,138,140,142,2,128,129,5,131,133,135,2,4,6,8,10,11,129,131,133,135,137,139,141,2,4,6,8,128,129,130,132,134,136,138,140,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,4,6,129,8,130,11,132,134,136,138,140,2,4,128,129,8,10,131,133,135,137,139,2,3,5,7,9,129,131,133,135,137,139,2,4,6,8,10,11,130,132,134,136,138,140,2,3,5,130,7,9,132,134,136,138,2,4,6,128,9,129,12,131,133,135,137,139,141,2,4,6,129,7,131,133,135,137,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,4,6,8,9,129,12,131,133,135,137,139,141,2,4,6,7,9,10,12,131,133,135,137,139,141,2,4,6,128,9,11,12,131,133,135,137,139,141,2,3,5,7,130,131,133,135,137,2,4,6,8,10,128,130,132,134,136,138,140,2,3,5,130,6,8,133,135,137,2,4,6,128,9,129,12,131,133,135,137,139,141,2,4,128,130,6,132,134,136,2,4,6,8,128,10,12,131,133,135,137,139,141,2,4,6,8,128,10,11,132,134,136,138,140,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,4,6,128,9,10,12,131,133,135,137,139,141,2,4,6,8,129,10,12,131,133,135,137,139,141,2,3,5,130,7,9,132,134,136,138,2,4,5,7,9,130,132,134,136,138,2,4,6,129,8,9,132,134,136,138,2,4,6,8,129,10,12,131,133,135,137,139,141,2,4,128,7,130,131,133,135,137,2,4,6,8,128,10,12,131,133,135,137,139,141,2,4,5,7,9,11,130,132,134,136,138,140,2,4,128,7,9,129,131,133,135,137,139,2,3,5,7,9,10,131,133,135,137,139,2,4,6,8,129,10,12,131,133,135,137,139,141,2,3,5,130,7,9,132,134,136,138,2,4,5,7,9,130,132,134,136,138,2,3,5,130,7,9,132,134,136,138,2,4,6,8,10,128,129,131,133,135,137,139,141,};

const uint8_t leaf_values[] = {2,58,0,9,35,75,255,2,45,5,40,255,92,92,6,26,0,22,242,245,18,21,1,184,9,84,8,20,224,2,50,10,0,13,255,37,2,221,16,9,168,41,255,11,131,83,3,29,0,63,1,26,1,10,83,4,8,102,194,24,20,0,147,5,255,60,152,139,0,63,2,59,255,7,36,3,50,0,0,147,7,127,7,128,255,9,1,21,7,35,54,255,9,96,110,35,2,35,76,0,51,209,0,74,148,9,0,51,5,4,134,19,255,12,106,5,44,6,109,23,2,18,138,9,0,225,31,2,63,45,255,5,63,22,154,83,6,5,163,22,0,255,70,126,5,139,114,79,0,14,247,187,0,255,11,6,99,0,33,158,97,4,255,49,35,0,27,253,232,77,20,202,1,72,18,73,217,3,76,5,207,3,86,4,241,0,20,255,118,214,14,6,89,217,35,5,139,255,16,28,0,214,5,255,1,0,18,195,229,21,9,86,8,100,64,2,255,7,179,234,19,0,47,7,53,92,20,255,10,124,3,213,12,223,13,67,226,0,118,220,21,0,72,3,9,180,74,255,26,166,93,12,143,5,1,95,4,12,244,18,127,146,13,71,1,21,255,0,84,27,152,7,202,0,106,32,36,255,7,152,21,247,174,23,76,0,217,22,19,130,7,145,15,255,106,18,92,6,21,255,154,3,105,181,0,34,86,169,23,219,35,3,95,6,206,3,106,41,0,218,4,102,255,200,12,0,184,2,179,255,68,77,0,234,7,105,255,255,2,0,215,21,248,24,111,12,5,91,72,2,22,23,189,212,22,0,56,53,4,86,255,255,0,82,240,21,175,33,23,204,19,179,0,27,205,10,84,133,20,195,74,13,88,1,68,255,11,7,86,249,1,92,230,10,198,4,236,59,88,0,255,21,8,231,33,0,41,255,171,9,27,255,107,195,28,90,0,207,9,9,109,102,6,248,20,255,142,28,230,69,220,6,1,203,0,52,115,215,26,185,60,7,90,23,255,1,102,36,0,7,113,216,104,1,10,27,174,14,255,0,88,186,30,0,69,41,203,255,0,251,35,162,10,249,31,236,24,2,132,80,3,25,42,203,104,8,0,66,66,5,255,82,248,100,255,30,129,6,211,86,27,189,0,34,0,79,0,34,216,31,223,19,122,20,122,2,91,255,19,3,117,255,88,0,86,158,21,169,9,68,196,87,5,209,23,11,246,39,0,104,255,12,179,171,10,172,81,0,255,18,2,131,248,69,0,63,36,18,238,18,180,7,175,255,88,0,103,22,224,129,232,34,130,237,8,115,5,232,0,132,52,0,7,243,255,120,0,85,8,205,82,4,191,107,255,2,83,179,19,255,24,36,187,0,102,7,129,16,201,1,63,235,21,95,4,33,219,27,116,13,0,82,86,7,105,255,111,255,36,203,9,222,44,105,7,61,204,0,43,0,3,0,73,7,255,85,237,9,111,25,133,205,34,4,126,255,95,0,96,164,27,2,247,44,200,5,83,193,16,11,255,45,0,88,253,184,14,0,28,133,255,219,103,29,204,7,108,25,228,151,225,2,184,245,64,6,161,255,114,0,57,96,24,33,233,19,14,192,15,214,7,161,52,0,5,255,111,252,3,255,15,3,123,217,18,174,0,86,163,219,49,44,166,0,255,31,206,41,2,118,35,219,14,209,22,170,6,108,40,34,199,238,43,7,144,80,0,255,115,123,255,42,126,7,58,227,96,4,208,69,0,51,0,21,16,171,126,17,36,208,114,255,227,25,8,255,70,36,189,0,115,27,229,9,159,119,7,234,26,13,221,67,0,75,218,11,255,0,11,145,3,112,255,236,22,15,129,43,112,231,16,255,142,198,83,226,226,3,3,182,0,55,86,27,0,1,67,144,25,164,35,3,118,104,12,255,41,2,128,0,85,11,209,46,25,172,108,255,1,93,170,10,161,0,163,10,35,179,16,149,3,108,255,17,7,42,40,192,233,40,0,108,124,11,255,103,0,214,41,156,25,204,69,118,7,134,255,190,17,0,180,21,114,5,216,14,17,176,255,114,12,12,231,26,0,139,215,49,85,255,8,120,234,23,207,10,42,0,119,229,255,122,24,133,0,255,44,109,34,1,86,59,223,51,119,255,23,146,10,162,49,238,3,129,14,238,255,114,0,73,95,36,143,228,4,179,165,20,75,224,186,100,59,0,170,7,255,55,24,124,255,106,0,121,192,28,0,76,23,196,5,134,1,22,156,13,43,178,4,116,74,0,169,33,255,111,5,46,255,163,9,185,222,27,56,0,0,255,97,19,121,241,95,145,13,75,211,26,251,0,178,26,7,67,221,32,210,255,52,14,19,202,28,51,194,0,133,95,255,129,21,201,85,190,17,140,56,0,255,124,28,134,19,0,57,255,2,241,234,32,120,58,242,26,144,12,255,0,202,134,11,124,239,8,132,211,31,119,33,0,21,126,184,32,4,127,179,13,20,130,33,255,4,147,31,130,113,255,43,166,77,1,76,5,33,200,0,132,0,106,19,163,92,233,104,3,59,231,174,255,8,205,0,200,21,253,33,14,116,134,5,255,57,0,204,95,206,35,213,28,201,47,255,133,0,134,17,5,197,36,255,26,161,226,27,0,144,7,184,255,131,14,242,235,111,124,24,238,23,185,155,20,0,151,46,119,255,31,133,47,198,254,144,33,187,255,65,25,111,183,0,213,47,0,173,4,255,21,204,10,146,254,16,100,70,241,209,0,54,254,13,115,37,255,147,9,184,48,12,146,112,213,35,153,255,38,6,121,69,0,0,111,156,13,239,134,110,4,67,237,255,156,11,209,0,186,23,2,90,229,54,255,94,193,26,0,214,104,197,55,84,4,226,90,85,255,2,135,25,76,0,171,19,111,205,67,255,0,19,14,191,111,224,117,12,63,206,173,14,255,78,};

const uint8_t X_test[SAMPLES_IN_FILE][SAMPLE_SIZE] = {
    {0,0,0,0,0,0,0,0,0,30,44,15,11,11,4,0,0,68,117,155,164,174,103,0,0,0,0,3,9,155,44,0,0,0,0,0,49,138,3,0,0,0,0,10,162,33,0,0,0,0,1,104,106,1,0,0,0,0,26,216,27,0,0,0},
    {0,0,64,156,141,10,0,0,0,21,186,78,187,40,0,0,0,2,13,54,201,16,0,0,0,0,13,185,72,0,0,0,0,1,109,159,4,0,0,0,0,12,216,55,17,13,30,50,0,8,178,199,215,179,166,124,0,0,5,8,14,8,2,0},
    {0,0,0,0,7,32,0,0,0,0,0,0,54,69,0,0,0,0,0,1,132,20,0,0,0,0,0,14,155,6,0,0,0,0,0,60,101,0,0,0,0,0,0,133,45,0,0,0,0,0,9,177,16,0,0,0,0,0,4,40,0,0,0,0},
    {0,0,0,19,50,1,0,0,0,0,14,158,207,30,0,0,0,2,137,245,195,199,23,0,0,22,222,94,10,124,161,2,0,46,172,2,5,129,183,4,0,65,183,62,145,236,60,0,0,23,201,243,225,97,3,0,0,0,16,62,27,1,0,0},
    {0,0,1,3,0,1,0,0,0,0,43,57,0,33,41,0,0,6,135,22,0,63,77,0,0,53,110,0,3,157,35,0,0,63,99,35,63,189,7,0,0,8,80,97,104,176,2,0,0,0,0,0,47,165,1,0,0,0,0,0,41,49,0,0},
    {0,0,0,0,2,6,0,0,0,0,0,0,74,137,1,0,0,0,0,4,182,79,0,0,0,0,0,28,211,17,0,0,0,0,0,89,158,1,0,0,0,0,3,169,69,0,0,0,0,0,10,192,16,0,0,0,0,0,4,99,6,0,0,0},
    {0,0,4,3,0,0,2,0,0,6,136,38,0,4,113,12,0,74,116,1,1,79,100,1,0,119,166,101,126,187,11,0,0,7,49,54,123,82,0,0,0,0,0,11,173,13,0,0,0,0,0,55,157,39,0,0,0,0,0,31,118,23,0,0},
    {0,0,0,0,0,0,0,0,0,0,14,112,13,0,0,0,0,1,128,228,166,12,0,0,0,6,161,44,225,61,0,0,0,2,148,184,142,129,1,0,0,0,12,37,9,163,26,0,0,0,0,0,0,51,128,2,0,0,0,0,0,2,123,21},
    {0,0,0,0,5,23,27,23,0,0,4,55,189,225,206,157,0,28,121,35,71,32,12,7,5,163,41,0,0,0,0,0,12,216,178,117,97,50,0,0,0,33,97,226,220,209,9,0,0,0,2,132,223,134,3,0,0,0,0,5,35,3,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,11,46,40,8,0,0,5,92,180,147,192,172,8,0,81,201,79,77,183,202,11,0,21,117,140,233,190,32,0,0,0,2,114,211,22,0,0,0,0,34,219,59,0,0,0,0,0,143,140,2,0,0,0},
    {0,0,4,22,49,28,2,0,0,1,124,182,144,186,92,0,0,7,168,22,1,27,187,9,0,43,130,1,0,5,174,12,0,79,63,0,0,8,178,12,0,104,63,0,5,84,138,2,0,55,169,147,176,174,17,0,0,2,54,77,54,9,0,0},
    {0,0,26,141,6,0,0,0,0,0,120,55,0,0,0,0,0,8,170,11,23,88,77,3,0,37,131,67,180,91,154,24,0,60,124,175,32,2,121,12,0,65,130,87,97,100,106,1,0,9,135,163,173,80,4,0,0,0,2,10,6,0,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,29,73,30,11,0,0,0,42,181,109,155,80,0,0,7,180,42,27,185,16,0,0,8,184,155,181,134,1,0,0,0,14,39,163,52,0,0,0,0,0,23,181,7,0,0,0,0,0,54,130,0,0,0},
    {0,0,0,2,12,7,0,0,0,0,18,158,212,184,9,0,0,3,147,175,39,176,73,0,0,20,213,40,0,53,155,1,0,49,176,2,0,43,183,4,0,48,179,4,0,63,120,1,0,4,133,64,26,159,29,0,0,0,9,93,127,59,1,0},
    {0,0,0,14,47,0,0,0,0,0,0,70,190,4,0,0,0,0,0,64,197,6,0,0,0,0,0,76,207,7,0,0,0,0,0,76,179,1,0,0,0,0,0,68,197,6,0,0,0,0,1,144,171,5,0,0,0,0,1,47,8,0,0,0},
    {0,0,8,29,70,50,4,0,0,10,183,125,75,17,1,0,0,1,131,48,14,0,0,0,0,14,165,116,140,96,11,0,0,1,8,0,3,44,131,16,0,0,4,0,0,1,76,65,0,23,129,53,68,110,120,11,0,3,44,65,50,23,3,0},
    {0,0,0,0,0,0,0,0,0,0,28,121,132,16,1,0,0,15,166,44,35,119,52,0,0,58,113,0,8,188,35,0,0,57,137,49,125,185,5,0,0,2,62,79,118,110,0,0,0,0,0,2,163,61,0,0,0,0,0,10,190,13,0,0},
    {0,0,0,0,0,0,0,0,10,72,68,42,24,5,0,0,14,116,127,154,193,185,45,0,0,0,0,1,10,125,104,0,0,0,0,0,13,195,52,0,0,0,0,3,131,151,3,0,0,0,0,80,196,18,0,0,0,0,17,211,69,0,0,0},
    {0,13,41,4,0,0,0,0,5,174,199,155,22,0,0,0,12,171,19,104,190,16,0,0,5,113,147,200,239,128,20,0,0,3,45,78,88,136,197,31,0,3,154,83,2,5,133,136,0,0,29,169,166,176,208,75,0,0,0,6,28,39,15,1},
    {0,0,0,0,0,5,0,0,0,0,3,1,1,114,6,0,0,0,95,25,6,137,3,0,0,4,141,18,34,126,0,0,0,15,190,131,164,172,5,0,0,1,13,2,101,62,1,0,0,0,0,0,119,31,0,0,0,0,0,0,83,16,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,10,88,88,19,0,0,0,26,174,215,247,134,0,0,7,188,199,208,226,30,0,0,4,93,72,154,99,1,0,0,0,0,60,181,9,0,0,0,0,13,189,54,0,0,0,0,0,98,164,9,0,0,0},
    {0,0,0,82,137,4,0,0,0,0,19,183,36,1,0,0,0,0,80,110,0,0,0,0,0,0,152,92,73,38,0,0,0,0,154,155,92,185,28,0,0,0,96,90,15,173,39,0,0,0,9,145,174,93,4,0,0,0,0,5,10,0,0,0},
    {0,0,96,20,0,0,0,0,0,7,149,6,0,0,0,0,0,42,128,0,38,107,40,0,0,54,106,6,160,73,145,2,0,26,154,53,121,23,136,2,0,2,107,198,158,153,37,0,0,0,1,51,196,58,0,0,0,0,0,0,10,3,0,0},
    {0,0,0,0,2,12,14,6,0,0,2,74,143,138,108,90,0,0,16,171,21,2,4,4,0,0,54,112,3,0,0,0,0,0,80,164,152,60,0,0,0,0,4,10,60,164,5,0,0,4,74,136,156,33,0,0,0,25,137,60,6,0,0,0},
    {0,0,0,4,0,0,0,0,0,0,32,68,11,9,0,0,0,1,94,13,37,58,0,0,0,25,101,1,68,58,0,0,0,48,109,56,90,105,14,0,0,0,8,16,75,75,2,0,0,0,0,0,29,73,0,0,0,0,0,0,7,81,0,0},
    {0,0,0,2,44,33,5,0,0,1,53,54,222,241,146,3,0,66,232,162,81,160,225,34,8,206,249,101,1,9,200,100,14,238,181,14,36,146,236,63,10,215,230,200,240,245,142,4,1,92,239,248,221,99,5,0,0,2,45,56,19,0,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,10,14,6,0,0,4,74,99,133,141,132,1,0,25,105,26,2,14,182,8,0,0,0,0,0,7,163,8,0,0,0,0,0,14,132,1,0,0,0,0,0,60,97,0,0,0,0,0,0,113,33,0,0},
    {0,0,0,6,0,0,0,0,0,0,6,139,7,54,35,0,0,0,75,136,2,125,45,0,0,25,187,29,4,163,17,0,0,64,217,185,155,197,9,0,0,2,11,33,85,150,1,0,0,0,0,0,92,108,0,0,0,0,0,0,52,39,0,0},
    {0,0,5,14,13,5,0,0,0,0,69,232,229,172,10,0,0,0,25,181,100,234,67,0,0,1,122,76,2,152,128,0,0,15,181,9,0,111,133,0,0,19,201,18,6,118,79,0,0,11,210,205,197,171,11,0,0,0,45,147,92,18,0,0},
    {0,0,3,49,0,0,0,0,0,0,9,180,15,0,0,0,0,0,0,126,64,0,0,0,0,0,0,139,87,0,0,0,0,0,0,59,152,0,0,0,0,0,0,50,165,1,0,0,0,0,0,49,189,5,0,0,0,0,0,9,50,1,0,0},
    {0,0,0,1,0,0,0,0,0,22,144,172,137,10,0,0,0,29,91,95,223,33,0,0,0,0,16,208,187,32,0,0,0,0,1,45,131,202,17,0,0,0,0,2,71,187,12,0,0,0,43,133,175,31,0,0,0,7,184,113,10,0,0,0},
    {0,0,0,7,1,0,0,0,0,0,0,124,38,0,0,0,0,0,0,91,80,0,0,0,0,0,0,47,149,1,0,0,0,0,0,13,172,6,0,0,0,0,0,6,175,11,0,0,0,0,0,3,172,15,0,0,0,0,0,0,82,25,0,0},
};
const uint8_t Y_test[SAMPLES_IN_FILE] = {7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 3, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1};

// Run inference using XGBoost
uint8_t predict(const uint8_t *x) {
    uint16_t votes[NUM_CLASSES] = { 0 };

    size_t tree_idx = 0;
    size_t node_base = 0;
    size_t leaf_base = 0;
    for (size_t i = 0; i < NUM_CLASSES; i++) {
        for (size_t j = 0; j < NUM_TREES; j++) {
            const uint8_t tree_size = tree_sizes[tree_idx];
            const uint8_t *tree_idxs = &comparison_idxs[node_base];
            const uint8_t *tree_values = &comparison_values[node_base];
            const uint8_t *tree_left_children = &left_children[node_base];
            const uint8_t *tree_right_children = &right_children[node_base];
            const uint8_t *tree_leaf_values = &leaf_values[leaf_base];

            // Find leaf node for this tree
            uint8_t node_id = 0;
            while(!(node_id & 0x80)) { // Leaf nodes have ID >= 128
                const uint16_t node_idx = tree_idxs[node_id];
                const uint8_t node_value = tree_values[node_id];
                if (x[node_idx] < node_value) { // Check condition for node
                    node_id = tree_left_children[node_id];
                } else {
                    node_id = tree_right_children[node_id];
                }
            }
            uint8_t leaf_idx = node_id & 0x7F; // Clear MSB to get leaf index
            uint8_t leaf_value = tree_leaf_values[leaf_idx];
            votes[i] += leaf_value;

            tree_idx++;
            node_base += tree_size;
            leaf_base += tree_size+1; // n internal nodes => n+1 leaves
        }
    }

    // return argmax of votes
    uint8_t class_idx = 0;
    uint16_t max_votes = votes[0];
    for (uint8_t i = 1; i < 10; i++) {
        if (votes[i] > max_votes) {
            class_idx = i;
            max_votes = votes[i];
        }
    }

    return class_idx;
}

int benchmark(void) {
    // Run inference with all samples specified in xgboost.c
    unsigned int sf = SCALE_FACTOR;
    size_t correct = 0;
	for (unsigned int sf_cnt = 0; sf_cnt < sf; sf_cnt++) {
        for (volatile size_t i = 0; i < SAMPLES_IN_FILE; i++) {
		  uint8_t predicted = predict(X_test[i]);
		  uint8_t label = Y_test[i];
		  if (predicted == label)
                correct++;
		}
	}

    return correct == 2 * SCALE_FACTOR;
}