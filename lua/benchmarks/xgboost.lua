
local SAMPLES_IN_FILE = 32
local SAMPLE_SIZE = 64
local NUM_CLASSES = 10
local NUM_TREES = 10
local SCALE_FACTOR = 1

local tree_sizes = {8,12,13,13,10,11,12,11,14,15,7,12,12,13,12,11,8,11,13,15,7,14,12,13,12,11,9,12,14,13,7,13,10,12,12,12,9,12,12,14,8,13,11,13,13,13,11,9,12,11,7,11,11,13,12,12,10,10,10,13,7,10,11,13,13,11,9,10,11,13,7,10,13,11,12,12,10,10,10,10,6,10,12,11,12,12,9,10,10,10,7,10,13,11,12,11,7,8,10,11}

local comparison_idxs = {36,28,36,21,42,52,13,18,19,10,46,20,3,27,5,3,41,10,20,9,62,37,45,54,45,38,52,44,26,53,12,27,19,26,43,26,19,45,46,18,28,13,51,30,54,54,33,58,58,33,30,5,41,13,4,13,21,5,58,13,42,26,43,18,3,4,21,21,42,4,2,54,2,46,61,53,1,4,2,60,26,60,37,17,29,6,35,46,53,60,38,42,27,45,21,9,43,51,43,13,43,18,42,34,29,21,43,51,42,33,17,61,42,36,29,44,3,43,43,36,28,36,43,34,33,21,19,10,38,20,3,10,13,26,10,28,18,45,62,37,46,54,45,45,37,44,26,27,19,3,26,43,18,30,51,59,54,63,33,4,11,62,20,33,41,44,33,26,3,37,12,50,50,46,13,21,5,58,42,42,26,5,22,50,4,13,21,42,46,59,61,4,20,36,60,25,6,53,18,60,60,29,26,38,14,38,42,27,58,51,62,38,46,30,27,21,54,18,43,29,43,45,27,29,17,20,52,34,21,50,52,38,50,36,28,36,13,28,6,21,19,10,12,20,3,63,38,38,61,10,45,53,28,61,62,26,46,37,54,45,37,50,49,37,19,26,26,43,18,30,51,54,54,19,41,4,11,59,5,33,30,44,59,19,50,2,21,4,34,5,61,21,5,58,42,42,25,36,41,61,11,21,21,42,46,59,61,4,9,34,42,53,26,7,37,15,60,18,44,60,18,42,30,38,21,27,52,35,9,43,20,41,20,20,36,42,34,43,21,17,54,42,38,60,29,4,18,36,13,29,36,28,36,59,34,34,21,19,3,12,20,10,63,28,30,36,45,52,14,44,26,38,63,51,63,9,19,36,10,4,26,43,54,30,50,18,20,4,2,9,26,29,33,41,44,12,27,33,37,53,49,22,41,13,21,5,58,36,2,26,42,51,28,20,19,21,21,42,34,59,61,46,4,49,13,53,26,7,37,15,60,26,22,60,18,42,22,38,42,38,45,51,27,42,43,27,12,9,18,43,29,17,53,27,38,60,21,54,35,33,36,50,29,36,28,36,13,28,3,33,21,19,3,20,30,10,63,10,44,51,17,4,36,59,26,38,63,27,63,4,19,45,36,9,62,26,43,53,19,50,26,18,30,9,2,17,18,58,33,41,44,12,27,30,5,53,4,33,37,37,43,21,5,4,36,2,12,36,42,51,28,22,6,57,21,42,33,59,54,46,51,53,9,27,41,61,26,14,37,18,61,36,19,15,38,42,38,45,51,27,36,43,50,14,9,43,42,21,34,54,18,27,52,51,5,27,3,36,42,36,13,28,37,34,19,3,12,20,10,63,9,43,45,42,38,26,38,63,27,63,4,19,45,44,9,62,26,43,12,30,50,26,21,34,42,29,46,26,54,33,4,44,11,41,3,37,22,34,43,27,5,21,5,58,36,42,3,11,51,18,5,21,12,21,42,33,59,54,46,27,46,9,42,61,26,14,37,12,38,57,53,18,29,38,21,38,20,35,28,52,22,50,18,43,21,60,4,27,17,38,29,52,35,10,50,10,36,33,28,26,6,21,13,19,3,20,20,61,10,29,42,29,34,26,38,63,54,63,4,20,61,45,9,62,26,43,54,29,51,18,20,42,18,29,11,45,4,33,4,44,53,41,30,13,22,13,33,2,37,38,21,5,58,35,2,3,25,5,20,21,12,21,42,34,54,46,21,46,9,50,61,26,22,38,12,35,52,36,18,29,35,22,13,22,22,50,43,45,50,26,51,42,44,34,21,21,4,17,62,26,17,61,5,54,36,28,28,33,21,34,13,19,3,12,20,63,58,17,52,41,51,26,51,63,45,53,62,19,50,63,61,27,54,45,26,51,54,19,45,18,4,30,9,37,20,33,4,58,53,41,61,33,22,13,5,41,30,21,5,4,36,2,12,6,42,43,20,13,14,21,42,33,59,61,46,22,54,2,53,61,26,14,37,35,38,22,43,44,18,38,35,38,22,21,28,60,52,18,18,43,21,60,54,27,17,50,35,36,34,36,42,28,13,21,43,19,3,42,20,10,51,30,43,11,20,26,45,63,53,52,4,9,27,51,54,9,62,26,43,1,19,13,46,17,30,9,7,29,33,4,44,53,41,3,2,22,13,43,5,12,21,20,6,2,35,4,36,5,4,18,17,12,21,42,33,54,46,42,18,9,41,61,26,22,38,29,35,52,35,20,12,35,22,50,27,54,21,44,18,20,60,43,33,60,18,6,17,26,21,62,43,36,33,28,18,50,21,43,19,3,12,30,63,5,17,42,46,10,26,51,63,45,53,62,19,9,62,44,43,54,45,26,45,12,13,42,21,22,29,29,44,54,33,60,44,4,41,30,13,12,33,2,37,33,21,20,6,2,18,4,14,5,41,35,12,21,42,29,3,61,13,20,61,26,38,12,52,35,18,53,38,27,38,34,50,51,28,45,42,33,42,36,34,27,26,35,21,44,21,21,54}

local comparison_values = {1,3,4,1,12,15,3,13,16,1,1,15,2,16,12,11,3,3,15,3,3,3,2,2,1,1,15,4,7,1,3,1,14,1,3,6,12,14,4,3,8,15,9,1,2,7,9,1,1,4,9,1,9,8,1,1,2,7,7,7,14,15,1,10,12,3,9,1,10,1,1,2,11,15,7,14,1,4,9,3,13,8,1,1,11,15,4,3,1,10,1,8,13,12,5,8,8,3,9,7,16,11,16,2,14,16,3,1,1,4,5,13,4,11,13,10,1,4,9,1,5,4,14,13,1,13,14,1,1,13,4,14,15,7,2,5,16,15,3,3,5,2,1,8,1,4,7,1,15,15,6,5,3,2,9,16,7,1,3,16,8,2,8,5,9,11,4,2,5,7,3,5,3,4,14,2,4,7,1,14,15,1,1,5,3,7,1,8,15,8,4,4,9,2,8,4,15,4,1,10,11,1,9,3,11,1,4,13,2,13,9,4,1,2,10,9,14,13,1,12,4,8,3,15,5,5,1,13,8,1,14,12,3,1,5,4,2,1,2,3,14,1,15,13,4,2,6,1,7,2,1,8,7,12,3,1,5,7,5,8,1,8,9,2,15,1,6,5,3,2,9,2,7,9,5,16,8,15,5,5,9,8,6,4,3,6,7,1,13,4,10,2,4,7,1,14,3,10,5,3,16,12,1,8,15,8,4,4,2,15,16,1,13,2,1,2,4,4,5,10,3,5,15,1,6,13,1,12,8,8,8,5,1,16,14,16,2,4,11,5,14,11,12,3,16,11,4,1,13,15,1,5,4,7,13,2,13,11,4,15,6,2,2,8,2,15,5,10,4,6,7,1,3,9,3,8,13,8,11,5,6,5,5,4,4,1,8,9,8,1,7,11,4,9,8,3,10,11,7,1,10,9,6,14,2,3,7,2,1,11,1,6,16,10,16,12,1,8,16,8,4,15,4,3,15,1,13,2,1,2,8,1,2,10,3,10,8,1,4,4,11,14,13,2,4,11,15,7,11,4,9,5,5,4,12,3,9,12,11,1,1,3,15,1,5,4,3,1,6,1,3,11,4,12,5,2,1,15,9,11,10,6,3,13,8,1,4,13,3,3,13,11,7,8,9,7,5,16,9,4,10,13,4,1,5,9,3,3,4,9,13,3,10,9,12,1,1,10,14,5,11,3,3,3,2,1,16,3,1,6,14,1,2,4,1,8,7,8,3,15,15,14,2,14,3,1,11,11,1,3,2,8,11,3,1,4,4,9,14,13,7,4,4,5,7,2,5,9,2,14,5,15,4,9,2,5,10,1,4,4,2,1,1,16,11,4,15,6,2,2,3,7,5,3,6,8,1,4,13,3,3,13,11,2,8,9,7,5,16,2,4,8,4,9,10,8,10,10,2,2,1,8,10,6,3,5,14,13,16,4,12,3,3,7,2,12,13,13,6,8,12,13,4,1,8,7,8,3,15,6,1,2,15,1,11,11,1,9,3,2,6,11,8,2,4,4,10,6,15,5,7,4,11,5,11,3,11,3,7,10,6,4,11,1,3,14,1,1,1,16,2,13,3,10,4,16,14,15,14,2,8,2,15,8,1,4,2,3,3,8,6,11,8,9,7,3,6,14,9,1,9,9,6,8,8,12,13,2,1,13,1,6,10,14,14,7,10,3,5,9,3,2,7,6,2,13,4,13,10,13,4,1,6,16,3,15,9,1,2,5,1,10,10,1,9,14,5,12,11,11,6,12,9,7,1,4,7,8,6,13,14,5,2,2,7,11,16,8,11,1,14,13,9,6,1,5,1,1,13,11,3,10,4,14,14,1,3,13,10,5,16,7,11,4,1,4,7,8,15,3,12,14,14,1,7,14,6,9,15,1,15,2,6,16,8,2,1,1,1,6,10,11,14,7,12,7,9,5,2,3,8,2,16,11,1,1,10,7,9,1,8,7,8,7,15,2,2,10,7,1,13,11,1,1,3,3,1,13,3,2,6,4,7,3,15,15,8,2,11,7,7,3,14,8,7,6,11,15,3,1,4,1,2,13,10,10,4,8,14,9,15,9,10,4,12,8,7,4,1,15,3,1,13,15,2,7,9,10,5,1,9,15,14,2,4,1,1,8,2,1,8,1,6,3,4,14,2,16,13,2,7,9,11,3,1,1,3,12,2,16,14,3,1,6,7,3,15,15,14,2,3,1,11,10,1,11,14,5,7,16,6,6,7,4,13,2,9,6,11,7,3,7,3,3,5,10,7,10,7,3,12,1,1,1,16,6,13,12,10,4,14,2,2,8,13,2,1,15,7,11,4,4,4,7,6,3,12,5,1,13,1,10,7,16,14,9,4,3,11,14,1,7,2,6,13,9,6,9,14,5,10,2,5,9,7,9,11,3,16,1,9,12,3,1,3,4,8,1,9,3,1,12,2,10,1,9,5,7,11,1,1,8,4,5,4,9,6,14,1,1,5,11,1,8,9,4,16,2,4,9,6}

local left_children = {1,3,5,6,130,132,133,135,1,3,5,7,128,10,129,131,133,135,137,139,1,3,5,7,9,10,11,130,132,134,136,138,140,1,3,5,7,8,9,11,130,132,134,136,138,140,1,3,128,6,8,129,131,133,135,137,1,3,128,6,7,9,130,132,134,136,138,1,3,5,7,8,129,10,131,133,135,137,139,1,3,5,128,129,8,10,132,134,136,138,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,4,5,131,132,134,1,3,5,128,7,9,130,131,133,135,137,139,1,3,5,7,9,10,129,131,133,135,137,139,1,3,5,7,9,11,129,130,132,134,136,138,140,1,3,5,7,128,130,10,131,133,135,137,139,1,3,128,6,7,9,130,132,134,136,138,1,3,5,129,131,7,133,135,1,3,5,7,129,9,130,132,134,136,138,1,3,5,7,9,128,12,130,132,134,136,138,140,1,3,5,7,9,11,13,128,130,132,134,136,138,140,142,1,3,4,130,6,132,134,1,3,5,128,8,10,12,129,131,133,135,137,139,141,1,3,5,7,8,10,129,131,133,135,137,139,1,3,5,7,9,128,129,130,132,134,136,138,140,1,3,5,7,128,10,11,131,133,135,137,139,1,3,128,6,7,9,130,132,134,136,138,1,3,5,129,131,7,132,134,136,1,3,5,7,9,10,129,131,133,135,137,139,1,3,5,7,9,128,12,129,131,133,135,137,139,141,1,3,5,7,9,10,11,130,132,134,136,138,140,1,3,4,130,131,132,134,1,3,5,128,8,9,11,130,132,134,136,138,140,1,3,5,7,128,130,131,133,135,137,1,3,5,7,8,9,10,131,133,135,137,139,1,3,5,7,128,9,10,131,133,135,137,139,1,3,128,6,8,10,129,131,133,135,137,139,1,3,5,128,130,131,133,134,136,1,3,5,7,9,10,129,131,133,135,137,139,1,3,5,6,8,10,129,131,133,135,137,139,1,3,5,7,9,11,12,129,131,133,135,137,139,141,1,3,4,5,7,131,133,135,1,3,5,7,8,9,11,130,132,134,136,138,140,1,3,5,7,128,9,130,132,134,136,138,1,3,5,7,9,10,12,130,132,134,136,138,140,1,3,5,7,128,9,11,130,132,134,136,138,140,1,3,5,7,9,128,11,130,132,134,136,138,140,1,3,5,128,7,130,9,132,134,136,138,1,3,128,6,129,130,132,134,136,1,3,5,6,8,10,129,131,133,135,137,139,1,3,5,6,8,10,130,132,134,136,138,1,128,4,130,6,132,134,1,3,5,128,129,8,10,132,134,136,138,1,3,5,7,128,9,130,132,134,136,138,1,3,5,7,9,10,12,130,132,134,136,138,140,1,3,5,128,7,130,10,131,133,135,137,139,1,3,128,6,8,10,129,131,133,135,137,139,1,3,5,128,7,130,132,133,135,137,1,3,128,6,8,129,131,133,135,137,1,3,5,129,7,130,131,133,135,137,1,3,5,7,9,128,129,130,132,134,136,138,140,1,3,5,129,6,132,134,1,3,4,129,6,8,131,133,135,137,1,3,5,7,128,9,130,132,134,136,138,1,3,5,7,9,11,129,130,132,134,136,138,140,1,3,5,128,7,9,11,130,132,134,136,138,140,1,3,128,6,7,9,130,132,134,136,138,1,128,4,6,129,8,132,134,136,1,3,128,6,8,129,131,133,135,137,1,3,4,129,7,9,130,132,134,136,138,1,3,5,7,9,11,129,130,132,134,136,138,140,1,3,4,5,130,132,134,1,3,4,129,6,8,131,133,135,137,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,5,7,128,130,9,132,134,136,138,1,3,5,128,7,9,11,131,133,135,137,139,1,3,5,7,8,129,10,131,133,135,137,139,1,3,5,128,7,130,9,133,135,137,1,3,128,6,8,129,131,133,135,137,1,3,5,129,7,130,131,133,135,137,1,3,5,129,7,130,131,133,135,137,1,128,4,130,131,133,1,3,4,129,6,8,131,133,135,137,1,3,5,128,8,10,129,131,133,135,137,139,1,3,5,7,9,128,130,132,134,136,138,1,3,5,128,7,130,10,131,133,135,137,139,1,3,5,7,9,128,129,131,133,135,137,139,1,128,4,6,129,131,132,134,136,1,3,128,6,8,129,131,133,135,137,1,128,4,129,6,8,131,133,135,137,1,3,5,6,8,130,131,133,135,137,1,3,5,129,131,132,134,1,3,4,129,6,8,131,133,135,137,1,3,5,7,9,11,128,130,132,134,136,138,140,1,3,128,6,8,10,130,132,134,136,138,1,3,5,7,129,8,10,131,133,135,137,139,1,3,5,7,128,129,130,132,134,136,138,1,3,128,129,131,132,134,1,2,4,6,129,131,133,135,1,3,5,129,7,130,131,133,135,137,1,3,5,7,128,129,131,132,134,136,138}

local right_children = {2,4,128,129,131,7,134,136,2,4,6,8,9,11,130,132,134,136,138,140,2,4,6,8,128,129,12,131,133,135,137,139,141,2,4,6,128,129,10,12,131,133,135,137,139,141,2,4,5,7,9,130,132,134,136,138,2,4,5,129,8,10,131,133,135,137,139,2,4,6,128,9,130,11,132,134,136,138,140,2,4,6,7,130,9,131,133,135,137,139,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,128,129,130,6,133,135,2,4,6,129,8,10,11,132,134,136,138,140,2,4,6,8,128,11,130,132,134,136,138,140,2,4,6,8,10,128,12,131,133,135,137,139,141,2,4,6,8,129,9,11,132,134,136,138,140,2,4,5,129,8,10,131,133,135,137,139,2,4,128,130,6,132,134,136,2,4,6,128,8,10,131,133,135,137,139,2,4,6,8,10,11,129,131,133,135,137,139,141,2,4,6,8,10,12,14,129,131,133,135,137,139,141,143,2,128,129,5,131,133,135,2,4,6,7,9,11,13,130,132,134,136,138,140,142,2,4,6,128,9,11,130,132,134,136,138,140,2,4,6,8,10,11,12,131,133,135,137,139,141,2,4,6,8,9,129,130,132,134,136,138,140,2,4,5,129,8,10,131,133,135,137,139,2,4,128,130,6,8,133,135,137,2,4,6,8,128,11,130,132,134,136,138,140,2,4,6,8,10,11,13,130,132,134,136,138,140,142,2,4,6,8,128,129,12,131,133,135,137,139,141,2,128,129,5,6,133,135,2,4,6,7,129,10,12,131,133,135,137,139,141,2,4,6,8,129,9,132,134,136,138,2,4,6,128,129,130,11,132,134,136,138,140,2,4,6,8,129,130,11,132,134,136,138,140,2,4,5,7,9,11,130,132,134,136,138,140,2,4,6,129,7,132,8,135,137,2,4,6,8,128,11,130,132,134,136,138,140,2,4,128,7,9,11,130,132,134,136,138,140,2,4,6,8,10,128,13,130,132,134,136,138,140,142,2,128,129,6,130,132,134,136,2,4,6,128,129,10,12,131,133,135,137,139,141,2,4,6,8,129,10,131,133,135,137,139,2,4,6,8,128,11,129,131,133,135,137,139,141,2,4,6,8,129,10,12,131,133,135,137,139,141,2,4,6,8,10,129,12,131,133,135,137,139,141,2,4,6,129,8,131,10,133,135,137,139,2,4,5,7,8,131,133,135,137,2,4,128,7,9,11,130,132,134,136,138,140,2,4,128,7,9,129,131,133,135,137,139,2,3,129,5,131,133,135,2,4,6,7,130,9,131,133,135,137,139,2,4,6,8,129,10,131,133,135,137,139,2,4,6,8,128,11,129,131,133,135,137,139,141,2,4,6,129,8,9,11,132,134,136,138,140,2,4,5,7,9,11,130,132,134,136,138,140,2,4,6,129,8,131,9,134,136,138,2,4,5,7,9,130,132,134,136,138,2,4,128,6,8,9,132,134,136,138,2,4,6,8,10,11,12,131,133,135,137,139,141,2,4,128,130,131,133,135,2,128,5,130,7,9,132,134,136,138,2,4,6,8,129,10,131,133,135,137,139,2,4,6,8,10,128,12,131,133,135,137,139,141,2,4,6,129,8,10,12,131,133,135,137,139,141,2,4,5,129,8,10,131,133,135,137,139,2,3,5,7,130,131,133,135,137,2,4,5,7,9,130,132,134,136,138,2,128,5,6,8,10,131,133,135,137,139,2,4,6,8,10,128,12,131,133,135,137,139,141,2,128,129,6,131,133,135,2,128,5,130,7,9,132,134,136,138,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,6,8,129,131,10,133,135,137,139,2,4,6,129,8,10,130,132,134,136,138,140,2,4,6,128,9,130,11,132,134,136,138,140,2,4,6,129,8,131,132,134,136,138,2,4,5,7,9,130,132,134,136,138,2,4,128,6,8,9,132,134,136,138,2,4,128,6,8,9,132,134,136,138,2,3,129,5,132,134,2,128,5,130,7,9,132,134,136,138,2,4,6,7,9,11,130,132,134,136,138,140,2,4,6,8,10,129,131,133,135,137,139,2,4,6,129,8,9,11,132,134,136,138,140,2,4,6,8,10,11,130,132,134,136,138,140,2,3,5,7,130,8,133,135,137,2,4,5,7,9,130,132,134,136,138,2,3,5,130,7,9,132,134,136,138,2,4,128,7,129,9,132,134,136,138,2,4,128,130,6,133,135,2,128,5,130,7,9,132,134,136,138,2,4,6,8,10,12,129,131,133,135,137,139,141,2,4,5,7,9,129,131,133,135,137,139,2,4,6,128,130,9,11,132,134,136,138,140,2,4,6,8,9,10,131,133,135,137,139,2,4,5,130,6,133,135,128,3,5,7,130,132,134,136,2,4,128,6,8,9,132,134,136,138,2,4,6,8,9,130,10,133,135,137,139}

local leaf_values = {0,255,2,82,2,9,36,9,96,95,1,108,2,103,253,89,30,0,25,152,255,12,0,8,39,2,219,8,2,107,13,255,38,2,219,7,9,62,36,255,1,25,52,4,189,11,2,114,0,8,255,169,5,5,106,192,26,23,0,140,2,0,140,63,2,59,255,8,36,37,2,131,11,0,35,12,8,126,7,118,255,9,11,0,35,12,44,121,3,110,82,255,1,61,181,20,15,0,0,51,5,11,194,1,43,255,30,6,44,1,41,203,3,18,135,9,0,221,36,2,62,255,63,41,4,53,0,125,9,5,0,20,5,86,245,20,255,10,237,1,197,18,56,0,11,232,7,131,28,255,0,191,2,98,5,249,23,255,4,253,88,5,187,239,0,244,36,6,84,6,255,67,0,6,88,5,77,28,255,169,51,2,159,3,78,0,11,120,242,63,0,1,19,179,209,20,78,9,78,6,255,48,69,82,0,9,0,255,19,160,9,10,223,255,85,28,242,141,13,4,131,0,32,0,2,26,227,3,84,87,255,10,117,90,14,18,168,12,204,153,19,0,181,16,255,118,8,242,18,0,94,112,1,7,0,25,7,247,39,30,255,14,250,125,22,244,74,0,97,10,126,255,48,236,13,158,5,202,3,57,255,0,107,215,3,245,107,192,8,9,0,229,105,8,98,8,221,83,1,89,255,11,107,8,0,11,164,3,82,1,29,255,163,26,200,50,0,2,255,40,237,88,113,15,1,83,218,9,91,105,3,15,255,24,14,191,0,23,255,246,87,162,5,245,19,243,10,19,189,0,92,0,33,253,15,102,168,22,235,94,21,110,2,101,255,8,3,91,5,112,255,51,28,196,36,0,19,245,2,90,9,0,31,9,35,245,36,255,28,0,255,107,40,124,81,6,99,248,6,198,54,231,2,236,0,221,31,207,1,119,255,206,12,9,1,0,59,174,20,255,17,89,89,2,183,7,84,199,134,255,6,2,85,0,74,7,128,184,39,0,255,34,83,2,14,98,225,101,1,98,207,8,118,4,20,0,108,221,255,64,6,101,249,255,96,10,176,246,27,240,17,9,184,0,46,0,0,75,15,255,113,250,106,3,4,122,13,175,119,21,247,11,78,11,204,225,74,52,0,255,27,3,111,12,0,12,44,103,104,255,49,243,31,0,97,255,132,44,11,176,238,43,47,221,106,8,3,216,218,43,255,69,236,10,21,205,0,51,2,7,195,18,10,168,4,203,17,143,47,0,24,255,106,230,255,11,103,4,0,163,33,214,62,220,20,109,27,255,228,39,83,3,17,105,222,27,17,243,0,108,103,4,0,108,27,178,209,33,7,121,255,27,0,247,218,24,137,16,255,104,17,234,14,120,14,31,255,0,250,61,228,19,153,28,202,0,157,90,3,255,31,211,6,75,225,97,8,14,0,38,15,49,255,108,225,37,101,0,19,255,151,100,12,253,133,234,78,4,214,222,52,255,79,241,14,25,208,0,59,3,5,168,26,12,81,170,5,19,156,30,0,24,255,255,22,127,0,108,32,173,3,79,86,12,181,43,0,228,44,93,3,57,237,9,222,255,25,155,12,132,7,0,138,12,194,7,253,46,26,255,1,27,224,20,151,255,46,148,0,17,237,6,7,14,255,44,0,110,88,223,31,226,9,0,21,184,76,0,1,197,43,204,255,39,25,205,0,11,169,50,17,230,83,255,0,42,245,133,15,255,40,149,242,21,112,6,205,89,210,7,180,255,82,29,201,0,65,0,6,248,77,186,2,236,16,172,2,52,137,20,255,255,27,0,116,178,39,5,143,211,39,51,198,16,130,0,4,31,209,17,174,255,101,253,32,167,18,7,0,122,12,156,10,229,41,26,255,0,29,229,251,12,106,255,143,1,46,231,120,2,34,142,2,91,16,239,0,186,255,117,181,9,19,246,102,255,15,150,169,0,26,107,39,127,21,0,21,219,40,159,92,255,14,60,250,25,165,103,252,255,60,0,231,227,96,76,237,2,188,11,192,255,133,0,91,191,20,4,150,85,0,224,31,22,226,5,142,35,255,255,34,196,0,127,186,47,213,62,18,164,15,123,5,43,240,206,28,153,18,227,92,60,0,255,33,139,9,0,144,18,24,178,238,39,33,255,0,36,228,20,243,73,255,96,254,210,23,4,0,18,51,236,148,8,65,244,46,255,0,3,15,255,102,32,223,244,81,255,124,24,0,54,25,213,255,134,10,62,236,255,52,40,167,228,0,45,234,16,115,198,255,151,4,114,34,236,41,189,0,80,0,157,255,29,252,30,20,197,10,118,245,23,255,41,149,0,138,188,90,7,111,216,57,159,16,150,255,40,17,174,46,238,79,218,1,96,64,0,11,0,126,18,40,168,209,46,255,60,0,39,226,243,16,118,255,8,116,21,204,0,34,198,112,5,28,255,11,159,16,255,0,150,19,17,200,69,219,6,97,255,128,0,24,135,92,30,211,255,145,0,225,84,20,154,239,147,194,21,255,95,223,122,44,239,6,143,179,18,86,255,0,95,194,29,0,17,2,84,177,27,223,46,162,4,77,255,19,0,117,255,83,4,150,207,66,60,204,24,142,7,154,255,46,22,177,247,84,218,89,72,0,128,133,11,34,96,0,255,44,0,243,17,109,255,137,6,205,33,3,0,15,18,255,14,226,27,245,227,35,10,217,54,6,195,0,91,255,33,175,39,187}

local X_test = {
    {0,0,0,0,0,0,0,0,0,30,44,15,11,11,4,0,0,68,117,155,164,174,103,0,0,0,0,3,9,155,44,0,0,0,0,0,49,138,3,0,0,0,0,10,162,33,0,0,0,0,1,104,106,1,0,0,0,0,26,216,27,0,0,0},
    {0,0,64,156,141,10,0,0,0,21,186,78,187,40,0,0,0,2,13,54,201,16,0,0,0,0,13,185,72,0,0,0,0,1,109,159,4,0,0,0,0,12,216,55,17,13,30,50,0,8,178,199,215,179,166,124,0,0,5,8,14,8,2,0},
    {0,0,0,0,7,32,0,0,0,0,0,0,54,69,0,0,0,0,0,1,132,20,0,0,0,0,0,14,155,6,0,0,0,0,0,60,101,0,0,0,0,0,0,133,45,0,0,0,0,0,9,177,16,0,0,0,0,0,4,40,0,0,0,0},
    {0,0,0,19,50,1,0,0,0,0,14,158,207,30,0,0,0,2,137,245,195,199,23,0,0,22,222,94,10,124,161,2,0,46,172,2,5,129,183,4,0,65,183,62,145,236,60,0,0,23,201,243,225,97,3,0,0,0,16,62,27,1,0,0},
    {0,0,1,3,0,1,0,0,0,0,43,57,0,33,41,0,0,6,135,22,0,63,77,0,0,53,110,0,3,157,35,0,0,63,99,35,63,189,7,0,0,8,80,97,104,176,2,0,0,0,0,0,47,165,1,0,0,0,0,0,41,49,0,0},
    {0,0,0,0,2,6,0,0,0,0,0,0,74,137,1,0,0,0,0,4,182,79,0,0,0,0,0,28,211,17,0,0,0,0,0,89,158,1,0,0,0,0,3,169,69,0,0,0,0,0,10,192,16,0,0,0,0,0,4,99,6,0,0,0},
    {0,0,4,3,0,0,2,0,0,6,136,38,0,4,113,12,0,74,116,1,1,79,100,1,0,119,166,101,126,187,11,0,0,7,49,54,123,82,0,0,0,0,0,11,173,13,0,0,0,0,0,55,157,39,0,0,0,0,0,31,118,23,0,0},
    {0,0,0,0,0,0,0,0,0,0,14,112,13,0,0,0,0,1,128,228,166,12,0,0,0,6,161,44,225,61,0,0,0,2,148,184,142,129,1,0,0,0,12,37,9,163,26,0,0,0,0,0,0,51,128,2,0,0,0,0,0,2,123,21},
    {0,0,0,0,5,23,27,23,0,0,4,55,189,225,206,157,0,28,121,35,71,32,12,7,5,163,41,0,0,0,0,0,12,216,178,117,97,50,0,0,0,33,97,226,220,209,9,0,0,0,2,132,223,134,3,0,0,0,0,5,35,3,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,11,46,40,8,0,0,5,92,180,147,192,172,8,0,81,201,79,77,183,202,11,0,21,117,140,233,190,32,0,0,0,2,114,211,22,0,0,0,0,34,219,59,0,0,0,0,0,143,140,2,0,0,0},
    {0,0,4,22,49,28,2,0,0,1,124,182,144,186,92,0,0,7,168,22,1,27,187,9,0,43,130,1,0,5,174,12,0,79,63,0,0,8,178,12,0,104,63,0,5,84,138,2,0,55,169,147,176,174,17,0,0,2,54,77,54,9,0,0},
    {0,0,26,141,6,0,0,0,0,0,120,55,0,0,0,0,0,8,170,11,23,88,77,3,0,37,131,67,180,91,154,24,0,60,124,175,32,2,121,12,0,65,130,87,97,100,106,1,0,9,135,163,173,80,4,0,0,0,2,10,6,0,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,29,73,30,11,0,0,0,42,181,109,155,80,0,0,7,180,42,27,185,16,0,0,8,184,155,181,134,1,0,0,0,14,39,163,52,0,0,0,0,0,23,181,7,0,0,0,0,0,54,130,0,0,0},
    {0,0,0,2,12,7,0,0,0,0,18,158,212,184,9,0,0,3,147,175,39,176,73,0,0,20,213,40,0,53,155,1,0,49,176,2,0,43,183,4,0,48,179,4,0,63,120,1,0,4,133,64,26,159,29,0,0,0,9,93,127,59,1,0},
    {0,0,0,14,47,0,0,0,0,0,0,70,190,4,0,0,0,0,0,64,197,6,0,0,0,0,0,76,207,7,0,0,0,0,0,76,179,1,0,0,0,0,0,68,197,6,0,0,0,0,1,144,171,5,0,0,0,0,1,47,8,0,0,0},
    {0,0,8,29,70,50,4,0,0,10,183,125,75,17,1,0,0,1,131,48,14,0,0,0,0,14,165,116,140,96,11,0,0,1,8,0,3,44,131,16,0,0,4,0,0,1,76,65,0,23,129,53,68,110,120,11,0,3,44,65,50,23,3,0},
    {0,0,0,0,0,0,0,0,0,0,28,121,132,16,1,0,0,15,166,44,35,119,52,0,0,58,113,0,8,188,35,0,0,57,137,49,125,185,5,0,0,2,62,79,118,110,0,0,0,0,0,2,163,61,0,0,0,0,0,10,190,13,0,0},
    {0,0,0,0,0,0,0,0,10,72,68,42,24,5,0,0,14,116,127,154,193,185,45,0,0,0,0,1,10,125,104,0,0,0,0,0,13,195,52,0,0,0,0,3,131,151,3,0,0,0,0,80,196,18,0,0,0,0,17,211,69,0,0,0},
    {0,13,41,4,0,0,0,0,5,174,199,155,22,0,0,0,12,171,19,104,190,16,0,0,5,113,147,200,239,128,20,0,0,3,45,78,88,136,197,31,0,3,154,83,2,5,133,136,0,0,29,169,166,176,208,75,0,0,0,6,28,39,15,1},
    {0,0,0,0,0,5,0,0,0,0,3,1,1,114,6,0,0,0,95,25,6,137,3,0,0,4,141,18,34,126,0,0,0,15,190,131,164,172,5,0,0,1,13,2,101,62,1,0,0,0,0,0,119,31,0,0,0,0,0,0,83,16,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,10,88,88,19,0,0,0,26,174,215,247,134,0,0,7,188,199,208,226,30,0,0,4,93,72,154,99,1,0,0,0,0,60,181,9,0,0,0,0,13,189,54,0,0,0,0,0,98,164,9,0,0,0},
    {0,0,0,82,137,4,0,0,0,0,19,183,36,1,0,0,0,0,80,110,0,0,0,0,0,0,152,92,73,38,0,0,0,0,154,155,92,185,28,0,0,0,96,90,15,173,39,0,0,0,9,145,174,93,4,0,0,0,0,5,10,0,0,0},
    {0,0,96,20,0,0,0,0,0,7,149,6,0,0,0,0,0,42,128,0,38,107,40,0,0,54,106,6,160,73,145,2,0,26,154,53,121,23,136,2,0,2,107,198,158,153,37,0,0,0,1,51,196,58,0,0,0,0,0,0,10,3,0,0},
    {0,0,0,0,2,12,14,6,0,0,2,74,143,138,108,90,0,0,16,171,21,2,4,4,0,0,54,112,3,0,0,0,0,0,80,164,152,60,0,0,0,0,4,10,60,164,5,0,0,4,74,136,156,33,0,0,0,25,137,60,6,0,0,0},
    {0,0,0,4,0,0,0,0,0,0,32,68,11,9,0,0,0,1,94,13,37,58,0,0,0,25,101,1,68,58,0,0,0,48,109,56,90,105,14,0,0,0,8,16,75,75,2,0,0,0,0,0,29,73,0,0,0,0,0,0,7,81,0,0},
    {0,0,0,2,44,33,5,0,0,1,53,54,222,241,146,3,0,66,232,162,81,160,225,34,8,206,249,101,1,9,200,100,14,238,181,14,36,146,236,63,10,215,230,200,240,245,142,4,1,92,239,248,221,99,5,0,0,2,45,56,19,0,0,0},
    {0,0,0,0,0,0,0,0,0,0,0,10,14,6,0,0,4,74,99,133,141,132,1,0,25,105,26,2,14,182,8,0,0,0,0,0,7,163,8,0,0,0,0,0,14,132,1,0,0,0,0,0,60,97,0,0,0,0,0,0,113,33,0,0},
    {0,0,0,6,0,0,0,0,0,0,6,139,7,54,35,0,0,0,75,136,2,125,45,0,0,25,187,29,4,163,17,0,0,64,217,185,155,197,9,0,0,2,11,33,85,150,1,0,0,0,0,0,92,108,0,0,0,0,0,0,52,39,0,0},
    {0,0,5,14,13,5,0,0,0,0,69,232,229,172,10,0,0,0,25,181,100,234,67,0,0,1,122,76,2,152,128,0,0,15,181,9,0,111,133,0,0,19,201,18,6,118,79,0,0,11,210,205,197,171,11,0,0,0,45,147,92,18,0,0},
    {0,0,3,49,0,0,0,0,0,0,9,180,15,0,0,0,0,0,0,126,64,0,0,0,0,0,0,139,87,0,0,0,0,0,0,59,152,0,0,0,0,0,0,50,165,1,0,0,0,0,0,49,189,5,0,0,0,0,0,9,50,1,0,0},
    {0,0,0,1,0,0,0,0,0,22,144,172,137,10,0,0,0,29,91,95,223,33,0,0,0,0,16,208,187,32,0,0,0,0,1,45,131,202,17,0,0,0,0,2,71,187,12,0,0,0,43,133,175,31,0,0,0,7,184,113,10,0,0,0},
    {0,0,0,7,1,0,0,0,0,0,0,124,38,0,0,0,0,0,0,91,80,0,0,0,0,0,0,47,149,1,0,0,0,0,0,13,172,6,0,0,0,0,0,6,175,11,0,0,0,0,0,3,172,15,0,0,0,0,0,0,82,25,0,0},
};

local Y_test = {7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 3, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1};

local function predict(x)
	local votes = {}
	for i = 1, NUM_CLASSES do
		votes[i] = 0
	end

	local tree_idx = 1
	local node_base = 1
	local leaf_base = 1

	for i = 1, NUM_CLASSES do
		for _ = 1, NUM_TREES do
			local tree_size = tree_sizes[tree_idx]
			local node_id = 0

			while (node_id & 0x80) == 0 do
				local idx = node_base + node_id
				local node_idx = comparison_idxs[idx]
				local node_value = comparison_values[idx]
				if x[node_idx] < node_value then
					node_id = left_children[idx]
				else
					node_id = right_children[idx]
				end
			end

			local leaf_idx = (node_id & 0x7f) + leaf_base
			local leaf_value = leaf_values[leaf_idx]
			votes[i] = votes[i] + leaf_value

			tree_idx = tree_idx + 1
			node_base = node_base + tree_size
			leaf_base = leaf_base + tree_size + 1
		end
	end

	local class_idx = 1
	local max_votes = votes[1]
	for i = 2, NUM_CLASSES do
		if votes[i] > max_votes then
			class_idx = i
			max_votes = votes[i]
		end
	end

	return class_idx
end

local function benchmark()
	local sf = SCALE_FACTOR
	local correct = 0

	for _ = 1, sf  do
		for i = 1, SAMPLES_IN_FILE do
			local predicted = predict(X_test[i])
			local label = Y_test[i]
			if predicted == label then
				correct = correct + 1
			end
		end
	end

	return correct == 2 * SCALE_FACTOR
end

return benchmark()